import{_ as B}from"./UiSelect.vue.78363163.js";import{_ as F}from"./UiButton.vue.e4d74fdb.js";import{_ as U}from"./UiInput.vue.f82dde06.js";import{_ as z}from"./FilterGroups.vue.499daa25.js";import{u as M}from"./useGlobalState.05eb19db.js";import{d as S,x as V,z as L,q as P,r as h,j as E,U as H,C as W,a as g,c as v,e as a,u as o,h as n,w as u,i as c,t as f,F as Z,v as A,p as T,m as J,s as K}from"./entry.1b4632b8.js";import{u as Q}from"./useToast.0d39c995.js";import"./useLanguagesStore.4ee7b7fd.js";const R={class:"max-w-xl m-auto w-full z-50 gap-3 flex flex-col rounded-md bg-white p-2"},X={class:"font-semibold grid grid-cols-6 text-lg text-gray-800 border-b-2 border-b-gray-500 pb-2 uppercase text-center"},Y=a("span",{class:"col-span-4 col-start-2"}," create a Salary ",-1),ee=a("svg",{xmlns:"http://www.w3.org/2000/svg",height:"24",width:"24"},[a("path",{d:"m12 13.4-4.9 4.9q-.275.275-.7.275-.425 0-.7-.275-.275-.275-.275-.7 0-.425.275-.7l4.9-4.9-4.9-4.9q-.275-.275-.275-.7 0-.425.275-.7.275-.275.7-.275.425 0 .7.275l4.9 4.9 4.9-4.9q.275-.275.7-.275.425 0 .7.275.275.275.275.7 0 .425-.275.7L13.4 12l4.9 4.9q.275.275.275.7 0 .425-.275.7-.275.275-.7.275-.425 0-.7-.275Z"})],-1),te=[ee],oe={class:"h-full w-full flex flex-col gap-2"},se={class:"w-full grid grid-cols-2 gap-2"},le={class:"px-2 py-1 flex items-center h-10 focus:outline-0 transition-all duration-200 focus:placeholder-a w-full border-2 rounded-md"},ae={key:0,class:"h-fit justify-start relative items-start bg-white p-2 rounded-md w-fit max-w-[26rem] flex flex-wrap gap-2"},ne=a("span",{class:"w-4 h-4 bg-white absolute top-[calc(50%-2rem)] rotate-45 -left-[0.4rem] -z-10"},null,-1),re={class:"font-semibold grid w-full grid-cols-6 text-lg text-gray-800 border-b-2 border-b-gray-500 pb-2 uppercase text-center"},ie=a("span",{class:"col-span-4 col-start-2"}," Months ",-1),ue={class:"w-full h-full flex flex-wrap gap-2"},ce={class:"w-full flex-col flex"},be=S({__name:"CreateSalary",setup(me){const{createSalary:k}=V(),{toggleModal:x}=M(),{toggleToast:C}=Q(),{Teachers:$,getTeacherPayments:D}=L(),{Groups:b}=P(),d=h(),r=h(!1),m=h(!1),e=E({teacherid:0,amount:0,groupid:0,monthid:0,date:"",payment_type:"",payment_amount:0}),O=s=>s.monthid!==0&&s.groupid!==0&&s.payment_type!==""&&s.payment_amount!==0,I=H(()=>e,async s=>{if(O(s)){if(s.payment_type==="fix"){d.value=s.payment_amount,e.amount=d.value;return}const{data:t,error:p}=await D(s.monthid,s.groupid);p&&console.log(p),d.value=((t==null?void 0:t.reduce((i,y)=>i+y.amount,0))??0)*(s.payment_amount/100),e.amount=d.value}},{deep:!0});W(()=>I());const w=["janvier","février","mars","avril","mai","juin","juillet","août","septembre","octobre","novembre","décembre"],j=async()=>{try{if(e.teacherid!==0&&e.groupid!==0){await k(e),x(!1);return}C({text:"fill all the feilds",role:"alert"})}catch(s){console.log(s)}},G=s=>{if(e.groupid!==s.id){e.groupid=s.id;return}e.groupid=0},N=s=>{if(e.monthid!==s){e.monthid=s;return}e.monthid=0};return(s,t)=>{const p=B,i=F,y=U,q=z;return g(),v("div",{class:K(["w-fit h-fit grid transition-all duration-150 gap-3 justify-center items-center min-w-[350px]",o(r)||o(m)?"grid-cols-2 grid-rows-1":"grid-cols-1 grid-rows-1"])},[a("div",R,[a("div",X,[Y,a("span",{onClick:t[0]||(t[0]=l=>o(x)(!1)),class:"cursor-pointer w-full flex items-center justify-end h-full"},te)]),a("div",oe,[n(p,{"onItem:select":t[1]||(t[1]=l=>o(e).teacherid=Number(l.id)),DisplayFeild:"fullname",Items:o($).map(l=>({fullname:l.fullname,id:l.id}))},{default:u(()=>[c(" Select Teacher ")]),_:1},8,["Items"]),n(i,{"onOn:click":t[2]||(t[2]=l=>(r.value=!o(r),m.value=!1)),Disable:!1,colorTheme:"b"},{default:u(()=>[c(f(o(e).monthid!==0?w[o(e).monthid-1]:"select months"),1)]),_:1}),n(i,{"onOn:click":t[3]||(t[3]=l=>(m.value=!o(m),r.value=!1)),Disable:!1,colorTheme:"b"},{default:u(()=>{var l;return[c(f(o(e).groupid!==0?(l=o(b).find(_=>_.id===o(e).groupid))==null?void 0:l.name:"select a group"),1)]}),_:1}),a("div",se,[n(p,{"onItem:select":t[4]||(t[4]=l=>o(e).payment_type=l.text.toLowerCase()),DisplayFeild:"text",Items:[{text:"fix"},{text:"pourcentage"}]},{default:u(()=>[c(f(o(e).payment_type==""?"method":o(e).payment_type),1)]),_:1}),n(y,{Placeholder:"amount",Type:"number","onOn:input":t[5]||(t[5]=l=>o(e).payment_amount=Number(l))})]),a("div",le,f(o(d)??0)+" DH ",1),n(i,{"onOn:click":j,Disable:!1,colorTheme:"a"},{default:u(()=>[c(" Create Salary ")]),_:1})])]),o(r)?(g(),v("div",ae,[ne,a("div",re,[ie,a("span",{onClick:t[6]||(t[6]=l=>r.value=!1),class:"cursor-pointer w-full h-full"}," x ")]),a("div",ue,[(g(),v(Z,null,A(w,(l,_)=>n(i,{"onOn:click":de=>N(_+1),Disable:!1,colorTheme:o(e).monthid===_+1?"":"b"},{default:u(()=>[c(f(l),1)]),_:2},1032,["onOn:click","colorTheme"])),64))]),a("div",ce,[n(i,{"onOn:click":t[7]||(t[7]=l=>r.value=!1),Disable:!1,colorTheme:"a"},{default:u(()=>[c(" Done ")]),_:1})])])):T("",!0),o(m)?(g(),J(q,{key:1,"onOn:close":t[8]||(t[8]=l=>m.value=!1),selected:o(e).groupid,groups:o(b),"onOn:select":G},null,8,["selected","groups"])):T("",!0)],2)}}});export{be as default};
